function prepareInfo() {
  
  var ss=SpreadsheetApp.getActiveSpreadsheet().getSheets()[0];
  var range=ss.getDataRange();
  var values=range.getValues();
  var lastRow=range.getLastRow()-1;
  var lastCol=range.getLastColumn();
  var sendToKaji=[""];
  //var sendToArmands=[""];
  var todayDate=new Date();
  var threeDays=3*1000*24*60*60;
  var todayPlusThree=new Date(todayDate.getTime() + threeDays);
  var editorToKaji=[""];
  //var editorToArmands=[""];
  
  for (var x=1;x<=lastRow;x++){
  
  var month=ss.getRange(x+7,6).getValue();
  var monthFormat=Utilities.formatDate(new Date(month),"GMT","dd-MMM-YYYY");
  var editor=ss.getRange(x+7,3).getValue();
  var dueDate=ss.getRange(x+7,23).getValue();
  var formatDueDate=Utilities.formatDate(new Date(dueDate),"GMT","dd-MMM-YYYY"); // wasn't working as var formatDueDate=Utilities.formatDate(dueDate,"GMT","dd-MMM-YYYY")
  var monitor=ss.getRange(x+7,21).getValue(); // was giving me problem because cell was WRAPPED!
  var userID=ss.getRange(x+7,2).getValue();
  var status=ss.getRange(x+7,18).getValue();
  var email="marc.bisbalarias@dowjones.com";
  var subject="Quality Monitoring due soon";
  //var message=editor + ": " + monthFormat + " QM is due on " + formatDueDate + ".";
  var message=editorToKaji.name + " QMs are due soon.";

  storeToKaji(ss,status,sendToKaji,monitor,todayPlusThree,threeDays,dueDate,editorToKaji,editor);
  //storeToArmands(ss,status,sendToArmands,monitor,todayPlusThree,threeDays,dueDate,editorToArmands,editor);
}

  sendEmails(email,subject,message);

}

function storeToKaji(ss,status,monitor,todayPlusThree,threeDays,dueDate,editorToKaji,editor,persona){ // problem: only editor info appears, we'd need more arrays but unsure how to make info readable; comma at start of array
if (status==="To Be Monitored" && monitor==="Kaji Senescal" && todayPlusThree-dueDate>=0){
var persona={name:editor,date:dueDate};
editorToKaji.push(persona);
}}

/*
function storeToArmands(ss,status,sendToKaji,monitor,todayPlusThree,threeDays,dueDate,editorToArmands,editor){
if (status==="To Be Monitored" && monitor==="Armands Nevedomskis" && todayPlusThree-dueDate>=0){
var persona={name:editor,date:dueDate};
editorToArmands.push(persona);
}};
*/

function sendEmails(email,subject,message){

//if (editorToKaji!=""){
MailApp.sendEmail(email,subject,message);
//} else if (editorToArmands!=""){
//MailApp.sendEmail(email,subject,message);
}
