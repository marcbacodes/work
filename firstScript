function onOpen() {
  
  var ui=SpreadsheetApp.getUi();
  ui.createMenu('Send reminder') // creating a menu in the spreadsheet
  .addItem('Send','sendReminder') // add the function sendReminder to the menu
  .addToUi();
}

function sendReminder(){
  
 var currentSheetTab = SpreadsheetApp.getActiveSpreadsheet().getSheets()[0];//Main tab in the Assignment Hub 
 var sheetRange = currentSheetTab.getDataRange();
 var sheetValues = sheetRange.getValues();//This creates an array of the values in the data range
 var lastRow = sheetRange.getLastRow() - 1;
 //var row=data[i]; 
  
      for (var i=1; i<=lastRow;i++){
        
        var email;
        var RAName=currentSheetTab.getRange(i+1,2).getValue(); // added .getValue() so it doesn't give an error in line 42 with email -- apparently without .getValue() it doesn't understand that this cell has a string
          switch (RAName){
            case "Bisbal, Marc":
            email="marc.bisbalarias@dowjones.com";
          break;
            case "Amaral, Sonia":
            email="sonia.amaralrohter@dowjones.com";
          break;
        }
        
        var correctionStatus=currentSheetTab.getRange(i+1,32) // sheetValues[i][33]; // correctionStatus is in column 32
        var emailStatus=currentSheetTab.getRange(i+1,39); // email status is in column 39
        var entityName=currentSheetTab.getRange(i+1,3).getValue();
        // var entityNameRange = SpreadsheetApp.getActiveSpreadsheet().getSheets().getRange(i+1,3); 
        // var entityName=entityNameRange.getValue(i+1,3);
        var subject="Pending QAs";
        var URLbase="https://docs.google.com/spreadsheets/d/";
        var fileID=currentSheetTab.getRange(i+1,14).getValue();
        var profileURL = URLbase + fileID;
        var message="You have QAs pending, please complete them when you have a moment: " + entityName + " " + profileURL;
        var emailMessageStatus="Email Sent";
        var errorSubject="Script error.";
        var errorMessage="There was an error with this profile: " + entityName + " " + profileURL;
        var errorEmail="marc.bisbalarias@dowjones.com";
        
        if (email==true && correctionStatus.getValue()==""){
          MailApp.sendEmail(email,subject,message);
          currentSheetTab.getRange(i+1,39).setValue(emailMessageStatus);
        } else {
          MailApp.sendEmail(errorEmail,errorSubject,errorMessage);
        }
}
};     
